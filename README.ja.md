# ClipboardMonitor

クリップボードを監視し、クリップボードに保存されているテキストデータを表示するツールです。

クリップボードに格納されている文字数を取得したり、URLが指し示しているタイトルを表示することができます。

![スクリーンショット](README.assets\2021-12-14_12h35_16.gif)

クリップボードの文字列になんらかの変換処理を行なうことも可能。クリップボード履歴ツールなどの各種ツールのお供にどうぞ。

## インストールとアンインストール

### インストール

内部的にPythonを利用しています。

[Python公式サイト](https://www.python.org/)などよりPythonをインストールし、コマンドプロンプトからpythonとコマンドを入力して実行できる状態にしてください。

その上でリリースパッケージをご自身の使いやすいフォルダに配置していただければOKです。

### アンインストール

リリースパッケージをフォルダごと削除してください。

また、個人設定は`%LOCALAPPDATA%\ClipboardMonitor`フォルダに配置されます。必要に応じて削除してください。

## 使い方

CMon.exeを起動してください。初期状態ではタスクトレイに常駐起動しますが、常駐せずタスクバーに表示されている状態で動作させることも可能です(設定で切り替え可能)。

ClipboardMonitorを起動している状態でクリップボードにテキストをコピーすると、自動的にその内容が取り込まれ、URLの場合はそのアドレスの指し示すサイトの情報が、それ以外のものでもその文字数などが表示されます。

### 現時点でサポートされている機能

これらの機能は、スクリプトフォルダに作成されるRunフォルダ配下にあるPythonスクリプトファイルにより実現されています。

![コピーした文字列の解析](README.assets\2021-12-14-12-30-39.png)

自分で好きな処理を追加することも可能です(処理内容については[Reference.ja.md](Reference.ja.md)を参照してください)。

* _charcount.py: 文字数をカウントする。もし[mdwc](https://github.com/fnobi/mdwc)コマンドがインストールされている環境であれば、それを使ってMarkdown換算の文字数も表示する。
* _colorcode.py: #RGBまたは#RRGGBBの文字列がコピーされたときのみ動作し、カラーコードの色表現を表示する。
* _urlchecker.py: httpまたはhttpsのURLをコピーしたときのみ動作し、URLにアクセスしたときのステータスコードおよび、`text/html`なリソースであればそのタイトルを表示する。

なお、`_urlchecker.py`がページのタイトルおよびステータスコードを取得する場合以外、Webアクセスは行っていません。

### 変換スクリプト

なお、メニューよりクリップボードの文字列になんらかの処理を行なう変換スクリプトを使用することも可能です。

![変換スクリプト](README.assets\2021-12-14-12-29-23.png)

これらの機能は、スクリプトフォルダに作成されるConversionフォルダ配下にあるPythonスクリプトファイルにより実現されています。

自分で好きな処理を追加することも可能です(処理内容については[Reference.ja.md](Reference.ja.md)を参照してください)。

* _bullet.py: Markdown記法の箇条書き記号をすべての行頭に付加します。
* _changelinkformat.py: テキスト内のリンク書式を変更します(Markdown記法→プレーンテキスト風や、HTML風など)
* _leaveurl.py: URLが含まれる文章から文章をすべて取り除きURLだけにします。

## 寄付受付

このアプリケーションはポイートで寄付を受け付けています。よろしければ寄付をお願いします。

* [poiit（ポイート）"誰にでも"ポイッと気軽に投げ銭できるサービス](https://poiit.me/TakamiChie)